<!DOCTYPE html>
<html lang="EN">
<head>
    <title>Chess Board HTML5</title>
    <meta charset="UTF-8">
    <style>
        .box { text-align: left; background-color: #eeeeee; float: left; }
        .form { text-align: center; background-color: #c7c9cc; margin: 20px; }
        .centered { display: inline-block; margin: 0; }
        .chess-board { border-spacing: 0; border-collapse: collapse; }
        .chess-board th { padding: .5em; }
        .chess-board td { border: 1px solid; width: 5em; height: 5em; text-align: center; vertical-align: middle; }
        .chess-board .white { background: #f0d9b5; }
        .chess-board .black { background: #b58863; }
        .img {width: 5em; height: 5em;}
        .button { margin: 5px;}
        .input { margin: 5px;}
    </style>
</head>
<body>

<div class="box">
    <div class="centered">

        <table class="chess-board">
            <tbody>
            <tr>
                <th></th>
                <th>a</th>
                <th>b</th>
                <th>c</th>
                <th>d</th>
                <th>e</th>
                <th>f</th>
                <th>g</th>
                <th>h</th>
            </tr>
            <tr>
                <th>8</th>
                <td class="white" id="a8"></td>
                <td class="black" id="b8"></td>
                <td class="white" id="c8"></td>
                <td class="black" id="d8"></td>
                <td class="white" id="e8"></td>
                <td class="black" id="f8"></td>
                <td class="white" id="g8"></td>
                <td class="black" id="h8"></td>
            </tr>
            <tr>
                <th>7</th>
                <td class="black" id="a7"></td>
                <td class="white" id="b7"></td>
                <td class="black" id="c7"></td>
                <td class="white" id="d7"></td>
                <td class="black" id="e7"></td>
                <td class="white" id="f7"></td>
                <td class="black" id="g7"></td>
                <td class="white" id="h7"></td>
            </tr>
            <tr>
                <th>6</th>
                <td class="white" id="a6"></td>
                <td class="black" id="b6"></td>
                <td class="white" id="c6"></td>
                <td class="black" id="d6"></td>
                <td class="white" id="e6"></td>
                <td class="black" id="f6"></td>
                <td class="white" id="g6"></td>
                <td class="black" id="h6"></td>
            </tr>
            <tr>
                <th>5</th>
                <td class="black" id="a5"></td>
                <td class="white" id="b5"></td>
                <td class="black" id="c5"></td>
                <td class="white" id="d5"></td>
                <td class="black" id="e5"></td>
                <td class="white" id="f5"></td>
                <td class="black" id="g5"></td>
                <td class="white" id="h5"></td>
            </tr>
            <tr>
                <th>4</th>
                <td class="white" id="a4"></td>
                <td class="black" id="b4"></td>
                <td class="white" id="c4"></td>
                <td class="black" id="d4"></td>
                <td class="white" id="e4"></td>
                <td class="black" id="f4"></td>
                <td class="white" id="g4"></td>
                <td class="black" id="h4"></td>
            </tr>
            <tr>
                <th>3</th>
                <td class="black" id="a3"></td>
                <td class="white" id="b3"></td>
                <td class="black" id="c3"></td>
                <td class="white" id="d3"><img class="img" id="king-img" src="images/king.jpg" alt="king"></td>
                <td class="black" id="e3"></td>
                <td class="white" id="f3"></td>
                <td class="black" id="g3"></td>
                <td class="white" id="h3"></td>
            </tr>
            <tr>
                <th>2</th>
                <td class="white" id="a2"></td>
                <td class="black" id="b2"></td>
                <td class="white" id="c2"></td>
                <td class="black" id="d2"></td>
                <td class="white" id="e2"></td>
                <td class="black" id="f2"></td>
                <td class="white" id="g2"></td>
                <td class="black" id="h2"></td>
            </tr>
            <tr>
                <th>1</th>
                <td class="black" id="a1"><img class="img" id="queen-img" src="images/queen.jpg" alt="Queen"></td>
                <td class="white" id="b1"></td>
                <td class="black" id="c1"></td>
                <td class="white" id="d1"></td>
                <td class="black" id="e1"></td>
                <td class="white" id="f1"></td>
                <td class="black" id="g1"></td>
                <td class="white" id="h1"></td>
            </tr>
            </tbody>
        </table>

    </div>
</div>

<div class="form">
    <h1>What coordinates should I move the shapes to?</h1>
    <form>
        <label> King
            <input class="input" id="king" type="text" placeholder="Entry b2 or 2b or 22"/></label>
        <br/>
        <label> Queen
            <input id="queen" type="text" placeholder="Entry g3 or 3g or 73"/></label>
        <br/><br/>
        <input class="button" type="submit" value="Move" />
    </form>
    <input class="button"  id="reset" type="submit" value="Reset" />
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', (event) => {
        const form = document.querySelector("form");
        var king = document.getElementById('king');
        var queen = document.getElementById('queen');

        document.getElementById('reset').onclick = function() {
            var kingImg = document.getElementById('king-img');
            var queenImg = document.getElementById('queen-img');

            kingImg ? kingImg.parentNode.removeChild(kingImg) : null;
            queenImg ? queenImg.parentNode.removeChild(queenImg) : null;

            setImg('images/king.jpg', 'd3', 'king-img', 'King')
            setImg('images/queen.jpg', 'a1', 'queen-img', 'Queen')
        }


        form.addEventListener("submit", function(event) {
            if(king.value){
                updateCoordinateKing(king.value);
            }

            if(queen.value){
                updateCoordinateQueen(queen.value);
            }

            event.preventDefault();
        }, false);

        function updateCoordinateKing(kingValue)
        {
            $.ajax({
                url: '/src/index.php',
                method: 'POST',
                data: {
                    king: parseCoordinates(kingValue),
                },
                success: function(){
                    var kingImg = document.getElementById('king-img');
                    kingImg.parentNode.removeChild(kingImg);

                    setImg('images/king.jpg', kingValue, 'king-img', 'King')
                },
                error() {
                    console.error("Can't move King to coordinates " + kingValue + '!');
                },
            })
        }

        function updateCoordinateQueen(queenValue)
        {
            $.ajax({
                url: '/src/index.php',
                method: 'POST',
                data: {
                    queen: parseCoordinates(queenValue),
                },
                success: function(){
                    var queenImg = document.getElementById('queen-img');
                    queenImg.parentNode.removeChild(queenImg);

                    setImg('images/queen.jpg', queenValue, 'queen-img', 'Queen')
                },
                error() {
                    console.error("Can't move Queen to coordinates " + queenValue + '!');
                },
            })
        }

        function parseCoordinates(coordinate)
        {
            const symbols = {
                a: 1,
                b: 2,
                c: 3,
                d: 4,
                e: 5,
                f: 6,
                g: 7,
                h: 8
            }

            if (!isNaN(parseInt(coordinate[0])) && !isNaN(parseInt(coordinate[1])))
            {
                return {
                    x: Number(coordinate[0]),
                    y: Number(coordinate[1])
                }
            }
            else if (!isNaN(parseInt(coordinate[0])))
            {
                return {
                    x: symbols[coordinate[1]],
                    y: Number(coordinate[0])
                }
            } else if (!isNaN(parseInt(coordinate[1]))) {
                return {
                    x: symbols[coordinate[0]],
                    y: Number(coordinate[1])
                }
            }
        }

        function parseCoordinatesForId(coordinates)
        {
            const symbols = {
                1: 'a',
                2: 'b',
                3: 'c',
                4: 'd',
                5: 'e',
                6: 'f',
                7: 'g',
                8: 'h'
            }

            if (!isNaN(parseInt(coordinates)))
            {
                return symbols[coordinates[0]] + coordinates[1];
            } else if (!isNaN(parseInt(coordinates[0])))
            {
                return symbols[coordinates[1]] + coordinates[0];
            } else {
                return coordinates;
            }
        }

        function setImg(img, coordinates, id, alt)
        {
            var newImg = document.createElement('img');

            newImg.setAttribute('class', 'img')
            newImg.setAttribute('id', id)
            newImg.setAttribute('alt', alt)
            newImg.setAttribute('src', img)

            if (!isNaN(parseInt(coordinates[0])) && isNaN(parseInt(coordinates[1])))
            {
                reverseCoordinates(coordinates)
            }

            var insertTd = document.getElementById(parseCoordinatesForId(coordinates));
            insertTd.appendChild(newImg);
        }

        function reverseCoordinates(coordinates)
        {
            coordinates = coordinates.split('');
            coordinates = coordinates.reverse('');
            coordinates = coordinates.join('');
        }
    })
</script>

</body>
</html>